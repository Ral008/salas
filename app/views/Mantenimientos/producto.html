#{extends 'main.html' /}
#{set title:'Producto' /}
<meta charset="utf8"/>
<div id="mensajes"></div>
<div class="well">
	<fieldset>
		<legend>:: Producto :: </legend>
		<div id="alert" class="alert alert-error" style="display: none;"><strong></strong>
		</div>
		<form class="form-horizontal" id="formularioProducto">
			<input name="coProducto" type="hidden" id="coProducto" value="" autocomplete="off">
			<div class="control-group">						
				<div class="row">
					<div class="span5">
					    <div class="control-group">
							<label class="control-label" for="coTipoProducto">Categoria</label>
							<div class="controls">
								<select name="coTipoProducto" id="coTipoProducto" class="select" autocomplete="off">
									<option value="00">Seleccione</option>
									#{list listTipoProducto,as:'tipoProducto'}
									<option value="${tipoProducto.coTipoProducto}">${tipoProducto.deNombre}</option>
									#{/list}
								</select>								
							</div>
						</div>						
					</div>
					<div class="span">
						<div class="control-group">
							<label class="control-label" for="coMedida">Unidad de medida</label>
							<div class="controls">
								<select class="span1_1" name="coMedida" id="coMedida" type="select-one">
									<option value="00">Seleccione</option>
									#{list listMedida,as:'medida'}
                                    <option value="${medida.coMedida}">${medida.deNombre}</option>
                                    #{/list}
								</select>
<!-- 								<input type="text" class="input-small" id="cantidadPorMedida" name="cantidadPorMedida" autocomplete="off" value="1"/> -->
							</div>
						</div>
					</div>																													
				</div>
				<div class="row">
					<div class="span5">
						<div class="control-group">
							<label class="control-label" for="deNombre">Nombre</label>
							<div class="controls">
							    <textarea id="deNombre" name="deNombre" rows="" cols="" placeholder="Nombre..." maxlength="100" autocomplete="off"></textarea>
							</div>
						</div>
					</div>
					<div class="span">
						<div class="control-group">
							<label class="control-label">Descripcion</label>
							<div class="controls">
								<textarea id="deDescripcion" name="deDescripcion" rows="" cols="" placeholder="Descripcion..." class="span4" maxlength="200" autocomplete="off"></textarea>
							</div>
						</div>
					</div>																																				
				</div>
				<div class="row">
					<div class="span5">
						<div class="control-group">
							<label class="control-label" for="stockMinimo">Stock minimo</label>
							<div class="controls">
								<div class="input-append">
									<input type="text" class="input" name="stockMinimo" id="stockMinimo" autocomplete="off" />
								</div>
							</div>
						</div>
					</div>
					<div class="span">
						<div class="control-group">
							<label class="control-label" for="stockMinimo">Dimensiones</label>
							<div class="controls">
								<input type="text" class="span1" id="altura" name="altura" placeholder="Altura" autocomplete="off"/>
								<input type="text" class="span1" id="ancho" name="ancho" placeholder="Ancho" autocomplete="off"/>
								<input type="text" class="span1" id="profundidad" name="profundidad" placeholder="Profund." autocomplete="off"/>
							</div>
						</div>
					</div>																																				
				</div>	
				<div class="row">
					<div class="span5">
					  <div class="control-group">
				        <label class="control-label" style="color: #333333;">Maximo 2 MB</label>
				        <div class="controls">
					       <button type="button" id="fileupload" class="btn btn-inverse">Foto</button>
					       <span class="help-inline"></span>
					       <img id="loadFoto" src="@{'/public/images/ajax-loaderCombo.gif'}" class="hide">
				        </div>
			          </div>
					</div>																																							
				</div>						
			</div>	
			<div class="control-group">  
				<div class="accordion">
					<div class="accordion-group">
						<div class="accordion-heading">
				      		<a class="accordion-toggle">
				      			Clasificacion
				      		</a>
				    	</div>		    
					   	<div id="1" class="accordion-body collapse in" style="height: height: 0px; ">
					    	<div class="accordion-inner">
								<div class="row">
									<div class="span">
										<div class="control-group">
										    <label class="control-label required-form" for="cboPais">Pais</label>
											<div class="controls">
												<select id="cboPais" type="select-one" name="cboPais" class="select input-medium" autocomplete="off">
													<option value="00">Seleccione</option>
													#{list listPais,as:'pais'}
   							 		                <option value="${pais.coPais}" >${pais.deNombre}</option>
    							                    #{/list}
												</select>
											</div>
										</div>
									</div>
									<div class="span">
										<div class="control-group">
										    <label class="control-label required-form" for="cboProveedor">Proveedor</label>
											<div class="controls">
												<select id="cboProveedor" type="select-one" name="cboProveedor" class="select" autocomplete="off">
													<option value="00">Seleccione</option>													
												</select>
											</div>
										</div>
									</div>									
									<div class="span">
										<div class="control-group">
											<label class="control-label required-form" for="codigoProductoProveedor">Cod. Prod. en proveedor</label>
											<div class="controls">
												<div class="input-append">
													<input type="text" id="codigoProductoProveedor" name="codigoProductoProveedor" class="input-small" autocomplete="off" /> 
												</div>
											</div>
										</div>
									</div>										
								</div>
								<div class="row">
								   <div class="control-group">
								      <div class="controls">
									     <div class="span5">
										    <button class="btn" id="btnAgregarClasificacion" type="button"><i class="icon-ok"></i>Agregar</button>
									     </div>	
									 </div>
								   </div>							
								</div>								
					      	</div>
					   	</div>
					</div>
				</div>
			</div>									
			<div class="form-actions">
				<button type="button" id="btnGuardar" class="btn btn-primary">Guardar</button>
				<button type="button" id="btnCancelar" class="btn">Cancelar</button>				
			</div>
		</form>		
	</fieldset>
</div>
<table class="table table-striped table-bordered table-condensed" >
	<thead>
		<tr>
			<th>Pais</th>			
			<th>Proveedor</th>
			<th>Cod. Prod. en proveedor</th>
			<th>Cantidad</th>
			<th>$ P. Venta</th>
			<th>#</th>
		</tr>
	</thead>
	<tbody id="tabla-de-productos-de-clasificacion"></tbody>	
</table>
<form action="" onsubmit="return false" class="well form-search" id="buscarProducto">
	<input type="text" name="txtNombreBuscar" id="txtNombreBuscar" class="input-xlarge" placeholder="Nombre del producto" autocomplete="off">
	<button type="submit" class="btn">Buscar</button>
	<img id="loadBuscar" src="@{'/public/images/ajax-loaderCombo.gif'}" class="hide">
</form>
<div class="modal hide" id="myModal">
  <div class="modal-header">
    <a class="close" data-dismiss="modal">x</a>
    <h3>Foto</h3>
  </div>
  <div class="modal-body">
  <div id="imagen"></div>
  </div>
</div>
#{pagination.pag lista:listProducto, titulo:'Producto', cab:'Id,Nombre,Descripcion,Unidad medida,Tipo Producto, Stock Min,Stock Actual,Estado,Opc', cantidadPestana:15, itemPag:500}
<tr>
<td key="coProducto" valor="${item.coProducto}">${item.coProducto}</td>
<td key="deNombre" valor="${item.deNombre}">${item.deNombre}</td>
<td key="deDescripcion" valor="${item.deDescripcion}">${item.deDescripcion}</td>
<td key="coMedida" valor="${item.vmdbMedida.coMedida}">${item.vmdbMedida.deNombre}</td>
<td key="coTipoProducto" valor="${item.vmdbTipoProducto.coTipoProducto}">${item.vmdbTipoProducto.deNombre}</td>
<td key="stockMinimo" valor="${item.stockMinimo}">${item.stockMinimo}</td>
<td>${item.stockActual}</td>
<td key="stProducto" valor="${item.stProducto}">${item.stProducto == '1' ? 'Activo' : 'Inactivo'}</td>
<td>
	<a class="btn btn-mini" id="u_${item.coProducto}"><i class="icon-pencil" title="Editar"></i></a>
	<a class="btn btn-mini" id="e_${item.coProducto}"><i class="icon-trash" title="Eliminar"></i></a>
    <a class="btn btn-mini" id="i_${item.coProducto}"><i class="icon-eye-open"></i> Foto</a>
</td>
</tr>
#{/pagination.pag}
<div class="modal hide" id="modalEditarDetalle">
	<input type="hidden" id="hddCie" autocomplete="off"/>
	<div class="modal-header"><h1>Editar Detalle del Producto</h1></div>
	<div class="modal-body">
		<form class="form-horizontal" action="#" onsubmit="return false;">			
			<div class="control-group">
				<label class="control-label">Pais</label>
				<div class="controls">
					<input type="text" id="paisModel" name="paisModel" autocomplete="off" readonly="readonly"/>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">Proveedor</label>
				<div class="controls">
					<input type="text" id="proveedorModel" name="proveedorModel" autocomplete="off" readonly="readonly"/>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">Cod. Prod. en Proveedor</label>
				<div class="controls">
					<input type="text" id="codigoProductoProveedorModel" name="codigoProductoProveedorModel" autocomplete="off"/>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">Cantidad</label>
				<div class="controls">
					<input type="text" id="cantidadModel" name="cantidadModel" autocomplete="off" readonly="readonly"/>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">$ P. Venta</label>
				<div class="controls">
					<input type="text" id="pVentaModel" name="pVentaModel" autocomplete="off"/>
				</div>
			</div>						
		</form>
	</div>
	<div class="modal-footer">
		<a href="#" class="btn" data-dismiss="modal">Close</a>
		<button class="btn btn-primary" id="btnGuardarModal">Save</button>		
	</div>
</div>
<script type="text/javascript">
var rutaPaginacionProducto = '@{Producto.paginacion()}';
var Productos = {
		capaDeMensajes : "mensajes",
		init : function(){
			$("#stockMinimo").numeric();
			//$("#altura").numeric();
			//$("#ancho").numeric();
			//$("#profundidad").numeric();
			$(document).delegate("a[id*='u_']","click",Productos.editarProducto);	
			$("#buscarProducto").submit(Productos.buscarProducto);
			$("#btnGuardar").click(Productos.guardarProducto);			
			$("#btnCancelar").click(Productos.cancelarProducto);
			$(document).delegate("a[id*='e_']","click",Productos.eliminar);
			$(document).delegate("a[id*='i_']","click",Productos.verImagen);
			$(document).delegate("#cboPais","change",Productos.cargarProveedores);
			$(document).delegate("#btnAgregarClasificacion","click",Productos.agregarClasificacionProducto);
			$(document).delegate("a[name='newDelete']","click",Productos.removeRow);
			$(document).delegate("a[name='editOld']","click",Productos.editarCodProveedorPVentaDelProducto);
			$(document).delegate("#btnGuardarModal","click",Productos.guardarCodProveedorPVentaDelProducto);
			$(document).delegate("a[name='oldDelete']","click",Productos.eliminarProveedorDelDetalle);
			var button = $('#fileupload'), interval;
			new AjaxUpload(button,{
				action: '@{Producto.guardarFoto()}',
				responseType: 'json',
				name: 'foto',
				onSubmit : function(file, ext){
					if (! (ext && /^(jpg|JPG|PNG|JPEG|GIF|png|jpeg|gif)$/.test(ext))){
						$("#loadFoto").hide();
		            	$("#fileupload").parents(".control-group").addClass("error").find(".help-inline").text('Seleccione una foto valida'); 
		                return false; 
		 			}else{
		 				if(this._input.files[0].size>2097152){
		 					$("#loadFoto").hide();
			            	$("#fileupload").parents(".control-group").addClass("error").find(".help-inline").text('El tamaÃ±o maximo es 2 MB'); 
			                return false; 
		 				}
		 				$("#loadFoto").show();
		 				$("#fileupload").parents(".control-group").find(".help-inline").empty();
		 			}
				},
				onComplete: function(file, response){
					//$("#deFoto").val('');
					$("#loadFoto").hide();
					$("#fileupload").parents(".control-group").removeClass("error").addClass("success").find(".help-inline").html(response[0]+' '+'<a href="javascript:Productos.verFoto()">View photo</a>');
		    	}
			});
		},	
		verFoto : function(){
			if($.trim($("#coProducto").val())!=''){
				$("#imagen").empty().html('<img src="@{Producto.verFoto()}?azar='+Math.random()+'&deFoto='+$("#coProducto").val()+'.jpg'+'" />');
			}else{
				$("#imagen").empty().html('<img src="@{Producto.verFoto()}?azar='+Math.random()+'" />');
			}
			$('#myModal').modal();
		},
		eliminarProveedorDelDetalle : function(){
			_this = this;
			_a = this.id.substring(3);
			if(confirm("Desea eliminar esta información ? ")){
				$.ajax({
					url: '@{Producto.eliminarProveedorDelDetalleById()}',
					data:{id : _a },
					success:function(result){
						if(result.status == 1){
							$.showMessage("success",result.message,Productos.capaDeMensajes,true);
							$(_this).parents("tr").remove();
						}else{
							$.showMessage("error",result.message,Productos.capaDeMensajes,true);
						}
					}				
				});
			}
		},
		editarCodProveedorPVentaDelProducto : function(){
			$("#paisModel").val($(this).data("idpaisname"));
			$("#proveedorModel").val($(this).data("idproveedorname"));
			$("#codigoProductoProveedorModel").val($(this).data("idcodigoproductoproveedor"));
			$("#cantidadModel").val($(this).data("idcantidad"));
			$("#pVentaModel").val($(this).data("idpventa"))
			$("#hddCie").val($(this).data("iddetalleproducto"));
			$("#modalEditarDetalle").modal("show");
		},
		guardarCodProveedorPVentaDelProducto : function(){
			$.ajax({
				url:"@{Producto.actualizarCodeProeveedorYPVenta()}",
				data:{id            : $("#hddCie").val(),
					  codigoPProve  : $("#codigoProductoProveedorModel").val(),
					  pVenta        :$("#pVentaModel").val()
				},
				success:function(result){
					if(result.status == 1){
						scroll(0,0);
						$.showMessage("success",result.message,"mensajes",true);
						$("#modalEditarDetalle").modal("hide");
						location.reload();
					}else{
						scroll(0,0);
						$.showMessage("error",result.message,"mensajes",true);
					}
				}
			})
		},
		removeRow : function(){
			_a = this;
			$(_a).parents("tr").remove();
		},
		agregarClasificacionProducto : function(e){
			e.preventDefault();
			var coPaisD = $("#cboPais").val();
			var coProveedorD  = $("#cboProveedor").val();
			var codigoProductoProveedorD = $("#codigoProductoProveedor").val();
			
			if((coPaisD ==null || $.trim(coPaisD) == "00") || (coProveedorD ==null || $.trim(coProveedorD) == "00") || (codigoProductoProveedorD == null || $.trim(codigoProductoProveedorD) == "")){
				scroll(0,0);
				$.showMessage("error","No hay ningun item seleccionado.",Productos.capaDeMensajes,true);			
			}else{
				if(Productos.validarIngreso(coPaisD,coProveedorD,codigoProductoProveedorD)){
					Productos.insertarRegistroNuevo();
					$("#cboPais").val("");
					$("#cboProveedor").val("");
					$("#codigoProductoProveedor").val("");
				}else{
					scroll(0,0);
					$.showMessage("error","Este item ya ha sido ingresado",Productos.capaDeMensajes,true);				
				}	
			}
		},
		validarIngreso : function(coPaisD,coProveedorD,codigoProductoProveedorD){
			var count = 0;
			$("#tabla-de-productos-de-clasificacion tr").each(function(){
			    _tr = this;
			    hidden = $(_tr).find(":hidden");    
			    if(hidden[1].id.substring(2) == coProveedorD || hidden[2].id.substring(2) == codigoProductoProveedorD){
			        count++;
			    }
			});
			if(count == 0){
			    console.info(true);
			    return true;
			}else{
			    console.info(false);
			    return false;
			}
		},
		insertarRegistroNuevo : function(){
			/*Datos para la pantalla*/
			paisName = $("#cboPais option:selected").html();
			proveedorName = $("#cboProveedor option:selected").html();
			codigoProductoProveedor = $("#codigoProductoProveedor").val();
			/*Codigos*/
			coPais = $("#cboPais").val();
			coProveedor = $("#cboProveedor").val();
			coCodigoProductoProveedor = $("#codigoProductoProveedor").val();
			
			var insertar = [{coPais : coPais,
							 coProveedor : coProveedor,
							 coCodigoProductoProveedor : coCodigoProductoProveedor,
							 paisName : paisName ,
							 proveedorName : proveedorName,
							 codigoProductoProveedor : codigoProductoProveedor,
							 cantidad : 0,
							 pVenta : 0
							}];
			
			$("#tabla-de-productos-de-clasificacion").append(Productos.completarClasificacionDeProductos(insertar,true));		
		},
		completarClasificacionDeProductos : function(json,isNew){
			var html="";
			for(var i = 0 ; i < json.length ; i++){
				if(isNew){
					html+="<tr name='new'>";	
				}else{
					html+="<tr>";	
				}				
			        html+="<td>";
				      html+="<input type='hidden' id='c_"+json[i].coPais+"' value="+json[i].coPais+" />";
				      html+=json[i].paisName;
			        html+="</td>";
					html+="<td>";
					  html+="<input type='hidden' id='v_"+json[i].coProveedor+"' value="+json[i].coProveedor+" />";
				      html+=json[i].proveedorName;
				    html+="</td>";
				    html+="<td>";
					  html+="<input type='hidden' id='p_"+json[i].coCodigoProductoProveedor+"' value="+json[i].coCodigoProductoProveedor+" />";
				      html+=json[i].codigoProductoProveedor;
				    html+="</td>";
					html+="<td>";
						html+=json[i].cantidad;
					html+="</td>";
					html+="<td>";
					    html+=json[i].pVenta;
			        html+="</td>";
					if(isNew){
						html+="<td>";
							html+="<a name='newDelete' class='btn btn-mini'><i class='icon-trash'></i></a>";
						html+="</td>";
					}else{
						html+="<td>";
	 						html+="<a name='editOld' class='btn btn-mini' data-idcopais='"+json[i].coPais+"' data-idpaisname='"+json[i].paisName+"' data-idcoproveedor='"+json[i].coProveedor+"' data-idproveedorname='"+json[i].proveedorName+"' data-idcodigoproductoproveedor='"+json[i].codigoProductoProveedor+"' data-idcantidad='"+json[i].cantidad+"' data-idpventa='"+json[i].pVenta+"' data-iddetalleproducto='"+json[i].id+"'><i class='icon-pencil'></i></a> ";																		
							html+="<a name='oldDelete' class='btn btn-danger btn-mini' id='dp_"+json[i].id+"'><i class='icon-trash icon-white'></i></a>";
						html+="</td>";
					}
				html+="</tr>";
			}
			return html;
		},
		cargarProveedores : function(){
			if($("#cboPais").val() !="00"){			
				$.ajax({
					url:"@{Producto.cargarProveedores()}",
					async: false,
					data:{
						coPais : $("#cboPais").val(),
					},
					success:function(RESULT){				
						var html ='<option value="00">Seleccione</option>'
						$.each(RESULT,function(key,value){												
							html+='<option value="'+value.coProveedor+'">';
							html+=value.deEmpresa;
							html+='</option>';
						});
						$("#cboProveedor").html(html);
					}
				});	
			}else{
				var html ='<option value="00">Seleccione</option>'
				$("#cboProveedor").html(html);
			}			
		},
		listar : function(){
			$("#txtNombreBuscar").val('');
			$("#loadBuscar").show();
			$('#paginationProducto').load('@{Producto.buscar()}?azar='+Math.random(),
			$("#buscarProducto").serialize(),
			function() {
				$("#loadBuscar").hide();
				$("#"+Productos.capaDeMensajes).slideUp("slow");
			});
		},
		editarProducto : function(){
			$("#formularioProducto").clearAll();
			_id = this.id.substring(2);	
			Productos.buscarProductoId(_id);
			$("#btnGuardar").text("Editar");	
		},
		buscarProductoId : function(_id){
			$.ajax({
				url:"@{Producto.buscarProductoById()}",
				data:{id : _id},
				success:function(json){
					if(json.length > 0){
						Productos.completarDatosDelProducto(json[0][0]);
						if(json[1]){
							detalleProd = Productos.completarClasificacionDeProductos(json[1]);
							$("#tabla-de-productos-de-clasificacion").html(detalleProd);
							/*Colocando popover a los botones de eliminar*/
							/*$("a[name='oldDelete']").popover({title:"Cuidado",placement:"left",content:"Si eliminas este registro, puedes alterar algunos que esten vinculados "});*/
						}else{
							$("#tabla-de-productos-de-clasificacion").empty();
						}
						scroll(0,0);
						$.showMessage("success","Se encontraron datos del producto",Productos.capaDeMensajes,true);
					}
				},
				complete:function(){
//	 				$("#formularioContacto").validateForm();
				}			
			})
		},
		completarDatosDelProducto : function(json){
			$.each(json,function(key,value){
				$("#"+key).val(value);
			})
		},
		buscarProducto : function(e){				
			e.preventDefault();
			$("#loadBuscar").show();
			$('#paginationProducto').load('@{Producto.buscar()}?azar='+Math.random(),
		    $("#buscarProducto").serialize(),
			function() {
				$("#loadBuscar").hide();
			});
			//$("#txtNombreBuscar").val('');
		},
		guardarProducto : function(){
		  if($("#coTipoProducto").val()=="00"){
			  scroll(0,0);
			  $.showMessage("error","Seleccione la categoria del producto",Productos.capaDeMensajes,true);
			  return false;
		  }else{
			  if($("#coMedida").val()=="00"){
				   scroll(0,0);
				   $.showMessage("error","Seleccione la unidad de medida",Productos.capaDeMensajes,true);
				   return false;
			   }else{
					if($.trim($('#deNombre').val())==''){
						scroll(0,0);
						$.showMessage("error","Ingrese el nombre del producto",Productos.capaDeMensajes,true);
						return false;
					}else{
						if($.trim($('#stockMinimo').val())==''){
							scroll(0,0);
							$.showMessage("error","Ingrese el stock minimo del producto",Productos.capaDeMensajes,true);
							return false;
						}else{
							if($.trim($('#altura').val())==''){
								scroll(0,0);
								$.showMessage("error","Ingrese la altura de la caja del producto",Productos.capaDeMensajes,true);
								return false;
							}else{
								if($.trim($('#ancho').val())==''){
									scroll(0,0);
									$.showMessage("error","Ingrese el ancho de la caja del producto",Productos.capaDeMensajes,true);
									return false;
								}else{
									if($.trim($('#profundidad').val())==''){
										scroll(0,0);
										$.showMessage("error","Ingrese la profundidad de la caja del producto",Productos.capaDeMensajes,true);
										return false;
									}else{
										$.ajax({
											url:"@{Producto.guardarProducto()}",
											data:{
												"producto.coProducto" 	                   : $("#coProducto").val(),
												"producto.vmdbTipoProducto.coTipoProducto" : $("#coTipoProducto").val(),
												"producto.vmdbMedida.coMedida"             : $("#coMedida").val(),													
												"producto.deNombre" 	              	   : $("#deNombre").val(),
												"producto.deDescripcion" 	   		  	   : $("#deDescripcion").val(),
												"producto.stockMinimo" 	   		  	       : $("#stockMinimo").val(),
												"producto.altura" 	                  	   : $("#altura").val(),
												"producto.ancho"                      	   : $("#ancho").val(),
												"producto.profundidad" 		          	   : $("#profundidad").val(),																																						
												"producto.stProducto"           	  	   : '1',	
												"codPais"		                      	   : $("tr[name='new'] input[id*='c_']").map(function(){
													    							             return this.value;
																			                 }).get().join("@"),	
												"codProveedor"		                  	   : $("tr[name='new'] input[id*='v_']").map(function(){
														    							         return this.value;
																				             }).get().join("@"),                                                    																			                																			                																			                
												"codigoCantidadPVenta"		               : $("tr[name='new'] input[id*='p_']").map(function(){
														                                         return this.value+","+$(this).parent().next().text()+","+$(this).parent().next().next().text();
																			                 }).get().join("@")						  
												},
												success:function(obj){
												 if(obj.status == 1 || obj.status == 2){
													scroll(0,0);
													$.showMessage("success",obj.message,Productos.capaDeMensajes,true);
													//Productos.cancelarProducto();
													//Productos.listar();
													location.reload();
												 }else{
													scroll(0,0);
													$.showMessage("error",obj.message,Productos.capaDeMensajes,true);
												 }
											    }
												});
										}
									}									
								}								
							}														
						}						 					   		
								   		  
			   }
		  } 		   					
		},
		eliminar : function(){
			if(confirm("Desea eliminar el producto? ")){
				_this = this;
				_id = this.id.substring(2);
				$.ajax({
					url:"@{Producto.eliminar()}",
					data:{id : _id},
					success:function(result){
						scroll(0,0);
						if(result.status == 1){							
							$.showMessage("success",result.message,Productos.capaDeMensajes,true);
							$(_this).parents("tr").remove();
						}else{
							$.showMessage("error",result.message,Productos.capaDeMensajes,true);
						}
					}
				})
			}									
		},
		verImagen : function(){
			_this = this;
			_id = this.id.substring(2);
		    $("#imagen").empty().html('<img src="@{Producto.verFoto()}?azar='+Math.random()+'&deFoto='+_id+'.jpg'+'" />');			
			$('#myModal').modal();
		},
		cancelarProducto : function(){	
			$("#tabla-de-productos-de-clasificacion").empty();
			$("#formularioProducto").clearAll();
			$("#formularioProducto").cleanForm();
			$("#btnGuardar").text("Guardar");
			location.reload();
			//$("#cantidadPorMedida").val(1);
		},
}
$(function(){
	Productos.init();
});
</script>